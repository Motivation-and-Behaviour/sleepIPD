<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Using `sleepIPD` to Reprocess Data • sleepIPD</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Using `sleepIPD` to Reprocess Data">
<meta property="og:description" content="sleepIPD">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">sleepIPD</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/sleepIPD.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/Motivation-and-Behaviour/sleepIPD/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="sleepIPD_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Using <code>sleepIPD</code> to Reprocess Data</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/Motivation-and-Behaviour/sleepIPD/blob/master/vignettes/sleepIPD.Rmd"><code>vignettes/sleepIPD.Rmd</code></a></small>
      <div class="hidden name"><code>sleepIPD.Rmd</code></div>

    </div>

    
    
<div id="quick-start" class="section level1">
<h1 class="hasAnchor">
<a href="#quick-start" class="anchor"></a>Quick Start</h1>
<p>One of the goals for this package was to make reprocessing data as easy as possible. If your study meets all of the criteria below, you should be able to reprocess your data with just a single call to <code><a href="../reference/reprocess.html">reprocess()</a></code>.</p>
<p><strong>Criteria</strong></p>
<ol style="list-style-type: decimal">
<li>You intend to run the analysis on a single computer (i.e., you do not intend to use a cluster).</li>
<li>Your data are stored in a format that <a href="https://cran.r-project.org/web/packages/GGIR/vignettes/GGIR.html#22_Prepare_folder_structure">GGIR understands</a> (Geneactiv <code>.bin</code> or <code>.csv</code>, Actigraph raw <code>.csv</code>, or Axivity <code>.cwa</code>).</li>
<li>Your folder structure contains only one of the above formats (i.e., your data are not duplicated in multiple formats).</li>
</ol>
<div id="running-with-reprocess" class="section level2">
<h2 class="hasAnchor">
<a href="#running-with-reprocess" class="anchor"></a>Running with <code>reprocess()</code>
</h2>
<div id="installation" class="section level3">
<h3 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h3>
<p>First, install the package. Since the package is not on CRAN, you will need <code><a href="https://devtools.r-lib.org//reference/remote-reexports.html">devtools::install_github()</a></code> or <code><a href="https://remotes.r-lib.org/reference/install_github.html">remotes::install_github()</a></code>. You will need to install one of these packages if you do not already have one. I recommend <code>devtools</code>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># install.packages("devtools") # uncomment if needed</span>
<span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://devtools.r-lib.org//reference/remote-reexports.html">install_github</a></span><span class="op">(</span><span class="st">"Motivation-and-Behaviour/sleepIPD"</span><span class="op">)</span></code></pre></div>
</div>
<div id="reprocessing-the-data" class="section level3">
<h3 class="hasAnchor">
<a href="#reprocessing-the-data" class="anchor"></a>Reprocessing the Data</h3>
<p>Next, provide sleepIPD with the information about how your data are stored, and information about the sample. The essential information is:</p>
<ul>
<li>
<strong>datadir:</strong> where are the data stored?</li>
<li>
<strong>outputdir:</strong> where can we safely store the outputs? <em>Note</em> - do <strong>not</strong> use the same location and data previously processed in GGIR. You risk overwriting your existing outputs. A new output folder just for this study would be sensible.</li>
<li>
<strong>studyname:</strong> what should we refer to this sample as? You can always use your last name.</li>
<li>
<strong>ages:</strong> how old is the sample? Can be either <code>"children"</code> (for those 18 or less), <code>"adults"</code> (for &gt;18) or both (i.e., <code><a href="https://rdrr.io/r/base/c.html">c("children", "adults")</a></code>). If you do not specify, both are used.</li>
<li>
<strong>device:</strong> what device did you use? an be either <code>"geneactiv"</code>, <code>"actigraph"</code> or (in the unlikely event two devices were used) both (i.e., <code><a href="https://rdrr.io/r/base/c.html">c("geneactiv", "actigraph")</a></code>). If you do not specify, both are used. Note that you can use <code>"geneactiv"</code> if your device was Axivity.</li>
<li>
<strong>wear_location:</strong> how did the sample wear the device. Can be either <code>"wrist"</code>, <code>"hip"</code> or (in the unlikely event multiple locations were used) both (i.e., <code><a href="https://rdrr.io/r/base/c.html">c("wrist","hip")</a></code>). If you do not specify, both are used.</li>
</ul>
<p>An example call might look like:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://motivation-and-behaviour.github.io/sleepIPD">sleepIPD</a></span><span class="op">)</span>

<span class="va">datadir</span> <span class="op">&lt;-</span> <span class="st">"C:\\Documents\\My Study\\Data"</span>
<span class="va">outputdir</span> <span class="op">&lt;-</span> <span class="st">"C:\\Documents\\My Study\\Output"</span>
<span class="va">studyname</span> <span class="op">&lt;-</span> <span class="st">"Hartwig 2021"</span>
<span class="va">ages</span> <span class="op">&lt;-</span> <span class="st">"children"</span>
<span class="va">device</span> <span class="op">&lt;-</span> <span class="st">"geneactiv"</span>
<span class="va">wear_location</span> <span class="op">&lt;-</span> <span class="st">"wrist"</span>

<span class="fu"><a href="../reference/reprocess.html">reprocess</a></span><span class="op">(</span>datadir <span class="op">=</span> <span class="va">datadir</span>, 
          outputdir <span class="op">=</span> <span class="va">outputdir</span>, 
          studyname <span class="op">=</span> <span class="va">studyname</span>, 
          ages <span class="op">=</span> <span class="va">ages</span>,
          device <span class="op">=</span> <span class="va">device</span>, 
          wear_location <span class="op">=</span> <span class="va">wear_location</span><span class="op">)</span></code></pre></div>
<p>Note that if you discover you have made a mistake and need to run this again, you’ll need to additionally set <code>overwrite = TRUE</code>.</p>
</div>
<div id="what-does-reprocess-do" class="section level3">
<h3 class="hasAnchor">
<a href="#what-does-reprocess-do" class="anchor"></a>What Does <code>reprocess()</code> Do?</h3>
<p><code><a href="../reference/reprocess.html">reprocess()</a></code> performs three steps, and moves the data between each step.</p>
<div id="step-one-reprocess-files" class="section level4">
<h4 class="hasAnchor">
<a href="#step-one-reprocess-files" class="anchor"></a>Step One: Reprocess Files</h4>
<p>This is the largest step. Here, sleepIPD calls <code><a href="../reference/process_files.html">process_files()</a></code>, which does the following:</p>
<ol style="list-style-type: decimal">
<li>Checks that you have the correct version of GGIR installed. sleepIPD can help you install the right version if it cannot find the correct version.</li>
<li>Determines the correct cut-points to apply to the data, based on information about your sample.</li>
<li>Calls <code><a href="https://rdrr.io/pkg/GGIR/man/g.shell.GGIR.html">GGIR::g.shell.GGIR()</a></code> to reprocess the data. This is where &gt;99% of the time will be spent.</li>
</ol>
</div>
<div id="step-two-collate-the-outputs" class="section level4">
<h4 class="hasAnchor">
<a href="#step-two-collate-the-outputs" class="anchor"></a>Step Two: Collate the Outputs</h4>
<p>GGIR can produce a lot of output files, but we only really need the summaries. Even so, depending on the configuration, there could be more than 1000 summary files. In this second step, sleepIPD calls <code><a href="../reference/collate_outputs.html">collate_outputs()</a></code>, which finds all of the output files and collapses them into just three files. These three files are stored in a new folder called <code>sleepIPD_output</code>, which will be located under the folder you specify in <code>outputdir</code>.</p>
<p>For example, if <code>outputdir</code> is <code>"C:\\Documents\\My Study\\Output"</code>, the collated files will be stored in <code>"C:\\Documents\\My Study\\Output\\sleepIPD_output"</code>.</p>
</div>
<div id="step-three-create-the-metadata-template" class="section level4">
<h4 class="hasAnchor">
<a href="#step-three-create-the-metadata-template" class="anchor"></a>Step Three: Create the Metadata Template</h4>
<p>To perform the integrated analysis, we will need additional information about the sample such as demographics. To try to make this simpler, sleepIPD calls <code><a href="../reference/build_meta.html">build_meta()</a></code> which will create the metadata template file and pre-fill it with the names of the files, and the wear location (if a single location was selected). You can then add the remaining information in, either by matching it to an existing spreadsheet or filling it manually.</p>
<p>The metadata template will be located in the folder you specify as the <code>outputdir</code>, and will be named <code>&lt;studyname&gt;-metadata.xlsx</code>. The <code>Metadata</code> sheet contains the information to fill out, and the other sheets explain the expected format.</p>
</div>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Taren Sanders.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
